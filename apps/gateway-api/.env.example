# Gateway API Configuration
# Copy this file to .env and fill in the values

# --- Required in Production ---

# Orchestrator service URL (REQUIRED in production)
# Example: https://orchestrator.example.com
ORCHESTRATOR_URL=

# Indexer service URL (REQUIRED in production)
# Example: https://indexer.example.com
INDEXER_URL=

# --- Server Configuration ---

# Port to listen on (default: 8080)
PORT=8080

# Maximum request body size in bytes (default: 1048576 = 1MB)
GATEWAY_MAX_REQUEST_BODY_BYTES=1048576

# Maximum file read size in bytes (default: 10485760 = 10MB)
GATEWAY_MAX_FILE_READ_BYTES=10485760

# --- Environment Mode ---

# NODE_ENV: Set to "production" or "prod" for production deployments
# RUN_MODE: Can be "production", "prod", "enterprise", "development", or "local"
NODE_ENV=development
RUN_MODE=local

# --- Rate Limiting ---

# Global HTTP rate limit - maximum requests per window
GATEWAY_HTTP_RATE_LIMIT_MAX=100

# Global HTTP rate limit window (e.g., "1m", "60s")
GATEWAY_HTTP_RATE_LIMIT_WINDOW=1m

# --- Networking ---

# Trusted proxy CIDRs (comma-separated list)
# Example: 10.0.0.0/8,192.168.0.0/16
GATEWAY_TRUSTED_PROXY_CIDRS=

# --- OAuth/OIDC ---

# Allow insecure OAuth state cookie (HTTP instead of HTTPS)
# WARNING: Only use for local development, never in production!
OAUTH_ALLOW_INSECURE_STATE_COOKIE=false

# OIDC Issuer URL
OIDC_ISSUER=

# OIDC Client ID
OIDC_CLIENT_ID=

# OIDC Client Secret (use secrets management in production)
OIDC_CLIENT_SECRET=

# OIDC Redirect Base URL (where the gateway is accessible)
OIDC_REDIRECT_BASE_URL=

# --- Cookie Security ---
# Keys for signing and encrypting OAuth state cookies.
# If not provided, random keys will be generated on startup (invalidating sessions on restart).
# HASH_KEY should be 64 bytes. BLOCK_KEY should be 32 bytes.
GATEWAY_COOKIE_HASH_KEY=
GATEWAY_COOKIE_BLOCK_KEY=

# --- Observability ---

# OpenTelemetry Configuration
OTEL_EXPORTER_OTLP_ENDPOINT=
OTEL_SERVICE_NAME=gateway-api

# --- Production Deployment Checklist ---
#
# Before deploying to production, ensure:
# 1. ✅ ORCHESTRATOR_URL is set to a valid HTTPS URL
# 2. ✅ INDEXER_URL is set to a valid HTTPS URL
# 3. ✅ NODE_ENV or RUN_MODE is set to "production" or "enterprise"
# 4. ✅ OAUTH_ALLOW_INSECURE_STATE_COOKIE is false or unset
# 5. ✅ All secrets are managed via secure secret stores (not in .env)
# 6. ✅ Rate limits are configured appropriately for your traffic
# 7. ✅ GATEWAY_MAX_FILE_READ_BYTES is set to prevent DoS
# 8. ✅ Trusted proxy CIDRs are configured if behind a proxy/load balancer
